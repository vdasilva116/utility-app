import{Q as G}from"./QInput-sEPPzbf-.js";import{a as b}from"./QBtn-BFVJIbQr.js";import{Q as T,a as V}from"./QItem-BJr2OZ2i.js";import{Q as U}from"./QList-CDRNOqyr.js";import{Q as z}from"./QPage-DTaGXjfD.js";import{t as K,r,o as P,b as j,y as B,z as f,u as S,A as h,D as s,J as L,C as F,B as c,I as p,K as J,L as O,E,_ as X}from"./index-BfLcs9a9.js";import"./use-key-composition-mMrpvGk-.js";import"./use-dark-CPCF1AuN.js";import"./render-Ck4TSlS7.js";import"./focus-manager-BJWzFvJg.js";const Y={class:"col-8"},H={class:"q-mt-md"},W={key:0,class:"q-mt-md"},Z={class:"col-4"},l=20,$=K({__name:"SnakeGame",setup(ee){const _=r(null),o=r(null),u=r([]),n=r("right"),v=r({x:0,y:0}),y=r(0),k=r(""),x=r(0),g=r([]),w=r(!1);let d=null,m=null;function I(){u.value=[{x:5,y:5}],n.value="right",y.value=0,k.value="",x.value=0,w.value=!1,q(),d&&clearInterval(d),m&&clearInterval(m),d=setInterval(M,150),m=setInterval(()=>x.value++,1e3)}function q(){v.value={x:Math.floor(Math.random()*(400/l)),y:Math.floor(Math.random()*(400/l))}}function M(){const e=u.value[0];if(!e)return;const[a,i]=[e.x,e.y],t={x:a,y:i};switch(n.value){case"up":t.y--;break;case"down":t.y++;break;case"left":t.x--;break;case"right":t.x++;break}if(t.x<0||t.x>=400/l||t.y<0||t.y>=400/l||u.value.some(C=>C.x===t.x&&C.y===t.y)){clearInterval(d),clearInterval(m),w.value=!0;return}u.value.unshift(t),t.x===v.value.x&&t.y===v.value.y?(y.value++,q()):u.value.pop(),R()}function R(){if(o.value){o.value.clearRect(0,0,400,400),o.value.fillStyle="#4caf50";for(const e of u.value)o.value.fillRect(e.x*l,e.y*l,l-2,l-2);o.value.fillStyle="#f44336",o.value.fillRect(v.value.x*l,v.value.y*l,l-2,l-2)}}function Q(e){const a=n.value;e.key==="ArrowUp"&&a!=="down"?n.value="up":e.key==="ArrowDown"&&a!=="up"?n.value="down":e.key==="ArrowLeft"&&a!=="right"?n.value="left":e.key==="ArrowRight"&&a!=="left"&&(n.value="right")}async function N(){const e=k.value.trim()||"Anonyme",{error:a}=await S.from("scores_snake").insert({name:e,score:y.value,time:x.value});a&&console.error("Erreur lors de l’enregistrement du score :",a),await A(),w.value=!1}async function D(){const{error:e}=await S.from("scores_snake").delete().neq("id","");e&&console.error("Erreur lors de la réinitialisation des scores :",e),g.value=[]}async function A(){const{data:e,error:a}=await S.from("scores_snake").select("*").order("score",{ascending:!1}).order("time",{ascending:!0}).limit(5);!a&&e&&(g.value=e)}return P(()=>{_.value&&(o.value=_.value.getContext("2d"),window.addEventListener("keydown",Q),I(),A())}),j(()=>{window.removeEventListener("keydown",Q),d&&clearInterval(d),m&&clearInterval(m)}),(e,a)=>(h(),B(z,{class:"q-pa-md row q-col-gutter-xl"},{default:f(()=>[s("div",Y,[a[2]||(a[2]=s("div",{class:"text-h5 q-mb-md"},"🐍 Snake",-1)),s("canvas",{ref_key:"canvas",ref:_,width:"400",height:"400",class:"snake-canvas"},null,512),s("div",H,"Score : "+p(y.value),1),s("div",null,"Temps : "+p(x.value)+"s",1),w.value?(h(),L("div",W,[a[1]||(a[1]=s("div",{class:"text-h6 text-negative"},"💀 Partie terminée !",-1)),c(G,{modelValue:k.value,"onUpdate:modelValue":a[0]||(a[0]=i=>k.value=i),label:"Votre nom",dense:"",outlined:"",class:"q-mt-sm"},null,8,["modelValue"]),c(b,{label:"Sauvegarder",color:"primary",onClick:N,class:"q-mt-sm"})])):F("",!0),c(b,{label:"Rejouer",color:"primary",class:"q-mt-md",onClick:I})]),s("div",Z,[a[3]||(a[3]=s("div",{class:"text-h6 q-mb-sm"},"🏆 Meilleurs scores",-1)),c(U,{bordered:"",separator:""},{default:f(()=>[(h(!0),L(O,null,J(g.value,(i,t)=>(h(),B(T,{key:t},{default:f(()=>[c(V,null,{default:f(()=>[E(p(i.name||"Anonyme"),1)]),_:2},1024),c(V,null,{default:f(()=>[E(p(i.score)+" pts - "+p(i.time)+"s",1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),c(b,{label:"Réinitialiser le classement",color:"negative",class:"q-mt-md",onClick:D,flat:""})])]),_:1}))}}),de=X($,[["__scopeId","data-v-65b80cb0"]]);export{de as default};
