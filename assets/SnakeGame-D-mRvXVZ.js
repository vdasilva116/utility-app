import{Q as G}from"./QInput-Cf17zoy7.js";import{Q as _}from"./QBtn-DKLCg6f7.js";import{Q as O,a as V}from"./QItem-DyI16qkB.js";import{Q as E}from"./QList-tFsmyv5N.js";import{Q as J}from"./QPage-Cyj_wye0.js";import{t as T,r as o,o as U,b as D,u as A,v as p,x as w,G as r,F as B,O as F,y as c,H as y,J as P,I as j,B as C,_ as z}from"./index-De15wrRx.js";import"./use-key-composition-Cf6ffK-U.js";import"./dom-CWUWeCtZ.js";import"./render-0Abd-KGh.js";import"./use-dark-BnlytlHe.js";const H={class:"col-8"},K={class:"q-mt-md"},X={key:0,class:"q-mt-md"},Y={class:"col-4"},l=20,W=T({__name:"SnakeGame",setup(Z){const S=o(null),n=o(null),v=o([]),i=o("right"),f=o({x:0,y:0}),x=o(0),k=o(""),g=o(0),u=o(JSON.parse(localStorage.getItem("snake-scores")||"[]")),h=o(!1);let m=null,d=null;function I(){v.value=[{x:5,y:5}],i.value="right",x.value=0,k.value="",g.value=0,h.value=!1,b(),m&&clearInterval(m),d&&clearInterval(d),m=setInterval(N,150),d=setInterval(()=>g.value++,1e3)}function b(){f.value={x:Math.floor(Math.random()*(400/l)),y:Math.floor(Math.random()*(400/l))}}function N(){const t=v.value[0];if(!t)return;const[e,s]=[t.x,t.y],a={x:e,y:s};switch(i.value){case"up":a.y--;break;case"down":a.y++;break;case"left":a.x--;break;case"right":a.x++;break}if(a.x<0||a.x>=400/l||a.y<0||a.y>=400/l||v.value.some(q=>q.x===a.x&&q.y===a.y)){clearInterval(m),clearInterval(d),h.value=!0;return}v.value.unshift(a),a.x===f.value.x&&a.y===f.value.y?(x.value++,b()):v.value.pop(),M()}function M(){if(n.value){n.value.clearRect(0,0,400,400),n.value.fillStyle="#4caf50";for(const t of v.value)n.value.fillRect(t.x*l,t.y*l,l-2,l-2);n.value.fillStyle="#f44336",n.value.fillRect(f.value.x*l,f.value.y*l,l-2,l-2)}}function Q(t){const e=i.value;t.key==="ArrowUp"&&e!=="down"?i.value="up":t.key==="ArrowDown"&&e!=="up"?i.value="down":t.key==="ArrowLeft"&&e!=="right"?i.value="left":t.key==="ArrowRight"&&e!=="left"&&(i.value="right")}function R(){const t=k.value.trim()||"Anonyme";u.value.push({name:t,score:x.value,time:g.value}),u.value.sort((e,s)=>s.score-e.score||e.time-s.time),u.value=u.value.slice(0,5),localStorage.setItem("snake-scores",JSON.stringify(u.value)),h.value=!1}function L(){u.value=[],localStorage.removeItem("snake-scores")}return U(()=>{S.value&&(n.value=S.value.getContext("2d"),window.addEventListener("keydown",Q),I())}),D(()=>{window.removeEventListener("keydown",Q),m&&clearInterval(m),d&&clearInterval(d)}),(t,e)=>(w(),A(J,{class:"q-pa-md row q-col-gutter-xl"},{default:p(()=>[r("div",H,[e[2]||(e[2]=r("div",{class:"text-h5 q-mb-md"},"🐍 Snake",-1)),r("canvas",{ref_key:"canvas",ref:S,width:"400",height:"400",class:"snake-canvas"},null,512),r("div",K,"Score : "+y(x.value),1),r("div",null,"Temps : "+y(g.value)+"s",1),h.value?(w(),B("div",X,[e[1]||(e[1]=r("div",{class:"text-h6 text-negative"},"💀 Partie terminée !",-1)),c(G,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=s=>k.value=s),label:"Votre nom",dense:"",outlined:"",class:"q-mt-sm"},null,8,["modelValue"]),c(_,{label:"Sauvegarder",color:"primary",onClick:R,class:"q-mt-sm"})])):F("",!0),c(_,{label:"Rejouer",color:"primary",class:"q-mt-md",onClick:I})]),r("div",Y,[e[3]||(e[3]=r("div",{class:"text-h6 q-mb-sm"},"🏆 Meilleurs scores",-1)),c(E,{bordered:"",separator:""},{default:p(()=>[(w(!0),B(j,null,P(u.value,(s,a)=>(w(),A(O,{key:a},{default:p(()=>[c(V,null,{default:p(()=>[C(y(s.name||"Anonyme"),1)]),_:2},1024),c(V,null,{default:p(()=>[C(y(s.score)+" pts - "+y(s.time)+"s",1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),c(_,{label:"Réinitialiser le classement",color:"negative",class:"q-mt-md",onClick:L,flat:""})])]),_:1}))}}),ue=z(W,[["__scopeId","data-v-2f907fa8"]]);export{ue as default};
