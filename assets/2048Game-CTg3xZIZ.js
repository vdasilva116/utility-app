import{a as q}from"./QBtn-DW49BdE9.js";import{Q as D}from"./QInput-B7YCRa1i.js";import{Q as T,a as L}from"./QItem-ImSksY7L.js";import{Q as j}from"./QList-Dn61JfwO.js";import{Q as z}from"./QPage-4aB-4sV1.js";import{t as J,r as f,o as P,y as M,z as v,u as Q,A as u,D as n,J as g,C as U,B as c,I as h,K as B,L as E,E as A,_ as F}from"./index-BwSv7cGb.js";import"./render-DxpCd_na.js";import"./use-key-composition-D-iEXPE9.js";import"./use-dark-CUTMrp-q.js";import"./focus-manager-BJWzFvJg.js";const K={class:"column items-center col-8"},O={class:"row items-center justify-between full-width q-mb-sm"},H={class:"text-caption q-mb-md"},W={class:"q-mb-md"},X={class:"grid-container"},Y={key:0,class:"q-mt-md text-negative"},Z={class:"col-4 q-ml-md"},s=4,$=J({__name:"2048Game",setup(ee){const a=f(Array(s*s).fill(0)),p=f(0),d=f(""),_=f(!1),b=f([]);function i(e,t){return t*s+e}function x(){const e=a.value.map((r,o)=>r===0?o:-1).filter(r=>r!==-1);if(e.length===0)return;const t=e[Math.floor(Math.random()*e.length)];a.value[t]=Math.random()<.9?2:4}function w(e){const t=e.filter(r=>r!==void 0&&r!==0);for(let r=0;r<t.length-1;r++)if(t[r]!==void 0&&t[r+1]!==void 0&&t[r]===t[r+1]){const o=t[r]*2;t[r]=o,p.value+=o,t.splice(r+1,1)}return[...t,...Array(s-t.length).fill(0)]}function I(e){let t=!1;const r=[...a.value];for(let o=0;o<s;o++){const m=[];for(let l=0;l<s;l++){const y=e==="left"||e==="right"?i(l,o):i(o,l);m.push(a.value[y])}const G=e==="left"?w(m):e==="right"?w(m.reverse()).reverse():e==="up"?w(m):w(m.reverse()).reverse();for(let l=0;l<s;l++){const y=G[l],C=e==="left"||e==="right"?i(l,o):i(o,l);a.value[C]!==y&&(r[C]=y,t=!0)}}t&&(a.value=r,x(),!a.value.includes(0)&&!N()&&(_.value=!0))}function N(){for(let e=0;e<s;e++)for(let t=0;t<s;t++){const r=a.value[i(t,e)];if(t<s-1&&r===a.value[i(t+1,e)]||e<s-1&&r===a.value[i(t,e+1)])return!0}return!1}function k(){a.value=Array(s*s).fill(0),p.value=0,_.value=!1,d.value="",x(),x()}async function V(){const{data:e,error:t}=await Q.from("scores_2048").select("*").order("score",{ascending:!1}).limit(5);!t&&e&&(b.value=e)}async function R(){if(!d.value.trim())return;const{error:e}=await Q.from("scores_2048").insert({name:d.value.trim(),score:p.value});e&&console.error("Erreur d'enregistrement",e),await V(),k()}async function S(){const{error:e}=await Q.from("scores_2048").delete().neq("id","");e&&console.error("Erreur suppression scores",e),b.value=[]}return P(()=>{k(),V(),window.addEventListener("keydown",e=>{_.value||["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)&&I(e.key.replace("Arrow","").toLowerCase())})}),(e,t)=>(u(),M(z,{class:"q-pa-md row justify-center"},{default:v(()=>[n("div",K,[n("div",O,[t[1]||(t[1]=n("div",{class:"text-h5"},"🧩 Jeu 2048",-1)),c(q,{label:"Relancer",color:"secondary",onClick:k})]),n("div",H,"Score : "+h(p.value),1),n("div",W,[n("div",X,[(u(!0),g(E,null,B(a.value,(r,o)=>(u(),g("div",{key:o,class:"tile"},h(r||""),1))),128))])]),_.value?(u(),g("div",Y,[t[2]||(t[2]=A(" 💀 Partie terminée ! ")),c(D,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=r=>d.value=r),label:"Ton nom",class:"q-mt-md",outlined:"",dense:""},null,8,["modelValue"]),c(q,{label:"Enregistrer le score",color:"primary",class:"q-mt-sm",onClick:R})])):U("",!0)]),n("div",Z,[t[3]||(t[3]=n("div",{class:"text-h6"},"🏆 Meilleurs scores",-1)),c(j,{bordered:"",separator:"",class:"q-mt-sm"},{default:v(()=>[(u(!0),g(E,null,B(b.value,(r,o)=>(u(),M(T,{key:o},{default:v(()=>[c(L,null,{default:v(()=>[A(h(r.name),1)]),_:2},1024),c(L,null,{default:v(()=>[A(h(r.score),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),c(q,{flat:"",label:"Reset scores",color:"negative",class:"q-mt-sm",onClick:S})])]),_:1}))}}),de=F($,[["__scopeId","data-v-61373ab7"]]);export{de as default};
