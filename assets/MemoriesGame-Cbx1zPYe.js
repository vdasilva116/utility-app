import{Q as h}from"./QBtn-DmMXl1xc.js";import{Q as j}from"./QInput-mMCxiqxR.js";import{Q as F,a as N}from"./QItem-DzZss20_.js";import{Q as U}from"./QList-CJMoOADg.js";import{Q as R}from"./QPage-C8CabdZW.js";import{x as A,r as s,a as H,e as J,y as g,o as O,B as q,C as d,D as v,G as r,M as C,F as P,E as n,L as c,N as T,O as E,H as k,_ as $}from"./index-Hz5f__gM.js";import"./render-BMVBRCea.js";import"./use-key-composition-CpwGdmmv.js";import"./use-dark-BUD6WyyA.js";import"./focus-manager-BJWzFvJg.js";const z={class:"row q-col-gutter-md q-gutter-md justify-center"},K={class:"col-12 col-md-8 column items-center"},W={class:"row items-center justify-between full-width q-mb-sm"},X={class:"text-caption q-mb-md"},Y={class:"row q-gutter-sm justify-center",style:{"max-width":"400px"}},Z={class:"text-h4"},ee={key:0,class:"q-mt-lg text-positive text-center"},ae={class:"col-12 col-md-4"},te=A({__name:"MemoriesGame",setup(se){const I=["🐶","🐱","🦊","🐻","🐼","🐸","🐵","🐔","🐷","🐮","🐯","🦁"],f=s([]),i=s([]),l=s([]),y=s(0),Q=s(0),p=s(0),m=s(null),w=s(!1),_=s(""),b=s([]),x=H(()=>i.value.every(e=>e));function G(){return[...I,...I].sort(()=>.5-Math.random())}function M(){f.value=G(),i.value=Array(f.value.length).fill(!1),l.value=[],y.value=0,p.value=0,w.value=!1,Q.value=Date.now(),m.value&&clearInterval(m.value),m.value=setInterval(()=>{p.value=Math.floor((Date.now()-Q.value)/1e3)},1e3)}function L(e){if(!(l.value.length>=2||l.value.includes(e))){if(l.value.push(e),l.value.length===2){y.value++;const[a,t]=l.value;a!==void 0&&t!==void 0&&f.value[a]===f.value[t]?(i.value[a]=!0,i.value[t]=!0,l.value=[]):setTimeout(()=>{l.value=[]},800)}x.value&&!w.value&&(w.value=!0,clearInterval(m.value))}}function B(){_.value="",M()}async function D(){if(!_.value.trim()||!u.value)return;const{error:e}=await g.from("scores_memory").insert({name:_.value.trim(),moves:y.value,time:p.value,user_id:u.value});e&&console.error("Erreur enregistrement score memory",e),await V(),B()}async function S(){if(!u.value)return;const{error:e}=await g.from("scores_memory").delete().eq("user_id",u.value);e&&console.error("Erreur suppression scores memory",e),b.value=[]}async function V(){if(!u.value)return;const{data:e,error:a}=await g.from("scores_memory").select("*").eq("user_id",u.value).order("moves",{ascending:!0}).order("time",{ascending:!0}).limit(5);!a&&e&&(b.value=e)}const u=s(null);return J(async()=>{const{data:e}=await g.auth.getUser();u.value=e.user?.id||null,M(),await V()}),O(()=>{m.value&&clearInterval(m.value)}),(e,a)=>(v(),q(R,{class:"q-pa-md"},{default:d(()=>[r("div",z,[r("div",K,[r("div",W,[a[1]||(a[1]=r("div",{class:"text-h5"},"🧠 Jeu de Memory",-1)),n(h,{label:"Relancer",color:"secondary",onClick:B})]),r("div",X,"Temps : "+c(p.value)+"s",1),r("div",Y,[(v(!0),C(E,null,T(f.value,(t,o)=>(v(),q(h,{key:o,class:"memory-card",onClick:le=>L(o),disable:i.value[o]||l.value.includes(o)},{default:d(()=>[r("span",Z,c(i.value[o]||l.value.includes(o)?t:"❓"),1)]),_:2},1032,["onClick","disable"]))),128))]),x.value?(v(),C("div",ee,[k(" 🎉 Bravo ! Tu as tout trouvé en "+c(y.value)+" coups et "+c(p.value)+"s ! ",1),n(j,{modelValue:_.value,"onUpdate:modelValue":a[0]||(a[0]=t=>_.value=t),label:"Ton nom",class:"q-mt-md",outlined:"",dense:""},null,8,["modelValue"]),n(h,{label:"Enregistrer",color:"primary",class:"q-mt-sm",onClick:D})])):P("",!0)]),r("div",ae,[a[2]||(a[2]=r("div",{class:"text-h6 text-center"},"🏆 Meilleurs scores",-1)),n(U,{bordered:"",separator:"",class:"q-mt-sm score-list"},{default:d(()=>[(v(!0),C(E,null,T(b.value,(t,o)=>(v(),q(F,{key:o},{default:d(()=>[n(N,null,{default:d(()=>[k(c(t.name),1)]),_:2},1024),n(N,{class:"text-right"},{default:d(()=>[k(c(t.moves)+" coups - "+c(t.time)+"s ",1)]),_:2},1024)]),_:2},1024))),128))]),_:1}),n(h,{flat:"",label:"Reset scores",color:"negative",class:"q-mt-sm full-width",onClick:S})])])]),_:1}))}}),pe=$(te,[["__scopeId","data-v-edc3218e"]]);export{pe as default};
